
<!DOCTYPE html>
<html lang="zh-CN" class="loading">
<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Kafka、RabbitMQ、RocketMQ等消息中间件的对比 - Cxy的博客</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="google" content="notranslate">
    <!--<meta http-equiv="Access-Control-Allow-Origin" content="*">-->
    <meta name="keywords" content="Cxy,"> 
    <meta name="description" content="消息中间件现在有不少，网上很多文章都对其做过对比，在这我对其做进一步总结与整理。
RocketMQ阿里系下开源的一款分布式、队列模型的消息中间件，原名Metaq，3.0版本名称改为RocketMQ，,"> 
    <meta name="author" content="Cxy"> 
    <link rel="alternative" href="atom.xml" title="Cxy的博客" type="application/atom+xml"> 
    <link rel="icon" href="/img/favicon.png"> 
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
    <link rel="stylesheet" href="/css/diaspora.css">
</head>
</html>
<body class="loading">
    <span id="config-title" style="display:none">Cxy的博客</span>
    <div id="loader"></div>
    <div id="single">
    <div id="top" style="display: block;">
    <div class="bar" style="width: 0;"></div>
    <a class="icon-home image-icon" href="javascript:;" data-url="http://CxyYuan.github.io"></a>
    <div title="播放/暂停" class="icon-play"></div>
    <h3 class="subtitle">Kafka、RabbitMQ、RocketMQ等消息中间件的对比</h3>
    <div class="social">
        <!--<div class="like-icon">-->
            <!--<a href="javascript:;" class="likeThis active"><span class="icon-like"></span><span class="count">76</span></a>-->
        <!--</div>-->
        <div>
            <div class="share">
                <a title="获取二维码" class="icon-scan" href="javascript:;"></a>
            </div>
            <div id="qr"></div>
        </div>
    </div>
    <div class="scrollbar"></div>
</div>

    <div class="section">
        <div class="article">
    <div class="main">
        <h1 class="title">Kafka、RabbitMQ、RocketMQ等消息中间件的对比</h1>
        <div class="stuff">
            <span>十二月 17, 2019</span>
            
  <ul class="post-tags-list"><li class="post-tags-list-item"><a class="post-tags-list-link" href="/tags/springcloud/">springcloud</a></li><li class="post-tags-list-item"><a class="post-tags-list-link" href="/tags/分布式/">分布式</a></li></ul>


        </div>
        <div class="content markdown">
            <p>消息中间件现在有不少，网上很多文章都对其做过对比，在这我对其做进一步总结与整理。</p>
<h3 id="RocketMQ"><a href="#RocketMQ" class="headerlink" title="RocketMQ"></a>RocketMQ</h3><p>阿里系下开源的一款分布式、队列模型的消息中间件，原名Metaq，3.0版本名称改为RocketMQ，是阿里参照kafka设计思想使用java实现的一套mq。同时将阿里系内部多款mq产品（Notify、metaq）进行整合，只维护核心功能，去除了所有其他运行时依赖，保证核心功能最简化，在此基础上配合阿里上述其他开源产品实现不同场景下mq的架构，目前主要多用于订单交易系统。<br>具有以下特点：</p>
<ul>
<li>能够保证严格的消息顺序</li>
<li>提供针对消息的过滤功能</li>
<li>提供丰富的消息拉取模式</li>
<li>高效的订阅者水平扩展能力</li>
<li>实时的消息订阅机制</li>
<li>亿级消息堆积能力</li>
</ul>
<p>官方提供了一些不同于kafka的对比差异：<br><a href="https://rocketmq.apache.org/docs/motivation/" target="_blank" rel="noopener">https://rocketmq.apache.org/docs/motivation/</a></p>
<h3 id="Kafka"><a href="#Kafka" class="headerlink" title="Kafka"></a>Kafka</h3><p>Apache下的一个子项目，使用scala实现的一个高性能分布式Publish/Subscribe消息队列系统，具有以下特性：</p>
<ul>
<li>快速持久化：通过磁盘顺序读写与零拷贝机制，可以在O(1)的系统开销下进行消息持久化；</li>
<li>高吞吐：在一台普通的服务器上既可以达到10W/s的吞吐速率；</li>
<li>高堆积：支持topic下消费者较长时间离线，消息堆积量大；</li>
<li>完全的分布式系统：Broker、Producer、Consumer都原生自动支持分布式，依赖zookeeper自动实现复杂均衡；</li>
<li>支持Hadoop数据并行加载：对于像Hadoop的一样的日志数据和离线分析系统，但又要求实时处理的限制，这是一个可行的解决方案。</li>
</ul>
<h3 id="RabbitMQ"><a href="#RabbitMQ" class="headerlink" title="RabbitMQ"></a>RabbitMQ</h3><p>RabbitMQ是使用Erlang语言开发的开源消息队列系统，基于AMQP协议来实现。AMQP的主要特征是面向消息、队列、路由（包括点对点和发布/订阅）、可靠性、安全。AMQP协议更多用在企业系统内，对数据一致性、稳定性和可靠性要求很高的场景，对性能和吞吐量的要求还在其次。</p>
<h3 id="ActiveMQ"><a href="#ActiveMQ" class="headerlink" title="ActiveMQ"></a>ActiveMQ</h3><p>Apache下的一个子项目。使用Java完全支持JMS1.1和J2EE 1.4规范的 JMS Provider实现，少量代码就可以高效地实现高级应用场景。可插拔的传输协议支持，比如：in-VM, TCP, SSL, NIO, UDP, multicast, JGroups and JXTA transports。RabbitMQ、ZeroMQ、ActiveMQ均支持常用的多种语言客户端 C++、Java、.Net,、Python、 Php、 Ruby等。</p>
<h2 id="有关测试结论"><a href="#有关测试结论" class="headerlink" title="有关测试结论"></a>有关测试结论</h2><p>Kafka的吞吐量高达17.3w/s，不愧是高吞吐量消息中间件的行业老大。这主要取决于它的队列模式保证了写磁盘的过程是线性IO。此时broker磁盘IO已达瓶颈。</p>
<p>RocketMQ也表现不俗，吞吐量在11.6w/s，磁盘IO %util已接近100%。RocketMQ的消息写入内存后即返回ack，由单独的线程专门做刷盘的操作，所有的消息均是顺序写文件。</p>
<p>RabbitMQ的吞吐量5.95w/s，CPU资源消耗较高。它支持AMQP协议，实现非常重量级，为了保证消息的可靠性在吞吐量上做了取舍。我们还做了RabbitMQ在消息持久化场景下的性能测试，吞吐量在2.6w/s左右。</p>
<p>在服务端处理同步发送的性能上，Kafka&gt;RocketMQ&gt;RabbitMQ。</p>
<p>对比了最简单的小消息发送场景,Kafka暂时胜出。但是,作为经受过历次双十一洗礼的RocketMQ,在互联网应用场景中更有它优越的一面。</p>
<h2 id="阿里官网对比"><a href="#阿里官网对比" class="headerlink" title="阿里官网对比"></a>阿里官网对比</h2><table>
<thead>
<tr>
<th>功能</th>
<th>消息队列 RocketMQ</th>
<th>ApacheRocketMQ（开源）</th>
<th>消息队列Kafka</th>
<th>ApacheKafka（开源）</th>
<th>RabbitMQ开源）</th>
</tr>
</thead>
<tbody>
<tr>
<td>  安全防护</td>
<td>支持</td>
<td>不支持</td>
<td>支持</td>
<td>不支持</td>
<td>支持</td>
</tr>
<tr>
<td>   主子账号支持</td>
<td>支持</td>
<td>不支持</td>
<td>支持</td>
<td>不支持</td>
<td>不支持</td>
</tr>
<tr>
<td>    可靠性</td>
<td>同步刷盘<br>同步双写<br>超3份数据副本<br>99.99999999%</td>
<td>同步刷盘<br>异步刷盘</td>
<td>同步刷盘<br>同步双写<br>超3份数据副本<br>99.99999999%</td>
<td>异步刷盘,丢数据概率高</td>
<td>同步刷盘</td>
</tr>
<tr>
<td>     可用性</td>
<td>非常好,99.95%<br>Always Writable</td>
<td>好</td>
<td>非常好,99.95%<br>Always Writable</td>
<td>好</td>
<td>好</td>
</tr>
<tr>
<td>     横向扩展能力</td>
<td>支持平滑扩展<br>支持百万级 QPS</td>
<td>支持</td>
<td>支持平滑扩展<br>支持百万级 QPS</td>
<td>支持</td>
<td>集群扩容依赖前端<br>LVS 负载均衡调度</td>
</tr>
<tr>
<td>     LVS 负载均衡调度</td>
<td>支持</td>
<td>不支持</td>
<td>支持</td>
<td>不支持</td>
<td>不支持</td>
</tr>
<tr>
<td>     消费模型</td>
<td>Push / Pull</td>
<td>Push / Pull</td>
<td>Push / Pull</td>
<td>Pull</td>
<td>Push / Pull</td>
</tr>
<tr>
<td>     定时消息</td>
<td>支持（可精确到秒级）</td>
<td>支持（只支持18个固定 Level）</td>
<td>暂不支持</td>
<td>不支持</td>
<td>支持</td>
</tr>
<tr>
<td>     事务消息</td>
<td>支持</td>
<td>不支持</td>
<td>不支持</td>
<td>不支持</td>
<td>不支持</td>
</tr>
<tr>
<td>     顺序消息</td>
<td>支持</td>
<td>支持</td>
<td>暂不支持</td>
<td>支持</td>
<td>不支持 </td>
</tr>
<tr>
<td>     全链路消息轨迹</td>
<td>支持</td>
<td>不支持</td>
<td>暂不支持</td>
<td>不支持</td>
<td>不支持 </td>
</tr>
<tr>
<td>     消息堆积能力</td>
<td>百亿级别<br>不影响性能</td>
<td>百亿级别<br>不影响性能</td>
<td>百亿级别<br>不影响性能</td>
<td>影响性能</td>
<td>影响性能     </td>
</tr>
<tr>
<td>     消息堆积查询</td>
<td>支持</td>
<td>支持</td>
<td>支持</td>
<td>不支持</td>
<td>不支持 </td>
</tr>
<tr>
<td>     消息回溯</td>
<td>支持</td>
<td>支持</td>
<td>支持</td>
<td>不支持</td>
<td>不支持 </td>
</tr>
<tr>
<td>     消息重试</td>
<td>支持</td>
<td>支持</td>
<td>暂不支持</td>
<td>不支持</td>
<td>支持 </td>
</tr>
<tr>
<td>     死信队列</td>
<td>支持</td>
<td>支持</td>
<td>不支持</td>
<td>不支持</td>
<td>支持 </td>
</tr>
<tr>
<td>     性能（常规）</td>
<td>非常好<br>百万级 QPS</td>
<td>非常好<br>十万级 QPS</td>
<td>非常好<br>百万级 QPS</td>
<td>非常好<br>百万级 QPS</td>
<td>非常好<br>万级 QPS  </td>
</tr>
<tr>
<td>     性能（万级 Topic 场景）</td>
<td>非常好<br>百万级 QPS</td>
<td>非常好<br>十万级 QPS</td>
<td>非常好<br>十万级 QPS</td>
<td>低</td>
<td>低 </td>
</tr>
<tr>
<td>     性能（海量消息堆积场景）</td>
<td>非常好<br>百万级 QPS</td>
<td>非常好<br>十万级 QPS</td>
<td>非常好<br>百万级 QPS</td>
<td>低</td>
<td>低 </td>
</tr>
</tbody>
</table>
<h3 id="对比"><a href="#对比" class="headerlink" title="对比"></a>对比</h3><p><img src="http://cxy-blog-1259223943.cos.ap-shanghai.myqcloud.com/Kafka%E3%80%81RabbitMQ%E3%80%81RocketMQ%E7%AD%89%E6%B6%88%E6%81%AF%E4%B8%AD%E9%97%B4%E4%BB%B6%E7%9A%84%E5%AF%B9%E6%AF%94/20191217050919271.png" alt></p>

            <!--[if lt IE 9]><script>document.createElement('audio');</script><![endif]-->
            <audio id="audio" loop="1" preload="auto" controls="controls" data-autoplay="true">
                <source type="audio/mpeg" src>
            </audio>
            
                <ul id="audio-list" style="display:none">
                    
                        <li title="0" data-url="https://cxy-blog-1259223943.cos.ap-shanghai.myqcloud.com/static/xiangwozheyangderen.mp3"></li>
                    
                        <li title="1" data-url="https://cxy-blog-1259223943.cos.ap-shanghai.myqcloud.com/static/xiangwozheyangderen.mp3"></li>
                    
                </ul>
            
        </div>
        
    <div id="gitalk-container" class="comment link" data-ae="false" data-ci="9d79f99be815238e8471" data-cs="0ba03abcb81c6434dc052ab8a0ecc10af5e081ba" data-r="CxyYuan.github.io" data-o="CxyYuan" data-a="CxyYuan" data-d="false">查看评论</div>


    </div>
    
</div>


    </div>
</div>
</body>
<script src="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<script src="//lib.baomitu.com/jquery/1.8.3/jquery.min.js"></script>
<script src="/js/plugin.js"></script>
<script src="/js/diaspora.js"></script>
<link rel="stylesheet" href="/photoswipe/photoswipe.css">
<link rel="stylesheet" href="/photoswipe/default-skin/default-skin.css">
<script src="/photoswipe/photoswipe.min.js"></script>
<script src="/photoswipe/photoswipe-ui-default.min.js"></script>

<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>
    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>



<!-- Google Analytics -->
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-140822910-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- End Google Analytics -->


</html>
